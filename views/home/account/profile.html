{{include_file name='home/public/header' title='账户设置'}}

</head>

<body>

<div id="wrapper">

    <!-- Navigation -->
    {{include_file name='home/public/nav' sidebar='home/account/sidebar' active='profile'}}
    <div id="page-wrapper">
        <div class="row">
            <div class="col-lg-12">
                <div class="page-header">
                    <h1>账户设置 </h1>
                </div>
            </div>
            <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->
        <div class="row">

            <div class="col-lg-12">

                <div class="panel panel-default">

                    {{include_file name='home/account/tab' tab='account'}}

                    <div class="panel-body">
                        <form role="form" id="js_settingForm" action="{{url('')}}" method="post">
                            <input type="hidden" name="csrf-phprap" value="{{csrf_token()}}" />

                            <div class="form-group">
                                <label>用户昵称</label>
                                <input class="form-control js_name" name="ProfileForm[name]" value="{{$user->name}}" placeholder="必填，至少2位" datatype="*2-250" nullmsg="请输入网站名称！">
                            </div>

                            <div class="form-group">
                                <label>登录邮箱</label>
                                <input class="form-control js_email" name="ProfileForm[email]" value="{{$user->email}}" placeholder="必填" datatype="e" nullmsg="请输入系统邮箱！" errormsg="请输入合法邮箱">
                            </div>

                            <div class="form-group">
                                <label>登录密码</label>
                                <input type="password" class="form-control" placeholder="登录密码，不少于6位" name="ProfileForm[password]" ignore="ignore" datatype="*6-20" nullmsg="请输入登录密码" errormsg="请填写6-20个字符">
                            </div>

                            <div class="form-group">
                                <label>确认密码</label>
                                <input type="password" class="form-control" placeholder="确认密码" recheck="ProfileForm[password]" nullmsg="请输入重复密码" errormsg="重复密码与密码不一致">
                            </div>

                            <button type="reset" class="btn btn-default mr-2">重置</button>
                            <button type="button" class="btn btn-primary js_submit">提交</button>

                        </form>

                    </div>
                    <!-- /.panel-body -->
                </div>
                <!-- /.panel -->
            </div>
            <!-- /.col-lg-12 -->
        </div>

    </div>
    <!-- /#page-wrapper -->

</div>
<!-- /#wrapper -->
<hr>
<p class="text-center">{{config('copyright')}}</p>

<script>
    $(function(){

        var submitBtn = '.js_submit';
        // 添加表单验证
        $("form").Validform({

            tiptype:function(msg,o){

                if(!o.obj.is("form")){

                    if(3 == o.type){
                        alert(msg, 'error');
                    }

                }
            },

            label:"label",

            btnSubmit: submitBtn,

            tipSweep:true,

            ignoreHidden:true,

            ajaxPost:true,

            beforeSubmit: function () {

                $(submitBtn).attr("disabled", "disabled");
            },

            callback:function(json){

//                console.log(json);return;

                if(json.status == 'success'){

                    alert(json.message, 'success', function () {
                        parent.location.reload();
                    });

                }else{

                    $(".js_" + json.label).focus().addClass('Validform_error');
                    $(submitBtn).removeAttr("disabled");
                    alert(json.message, 'error');

                }

            }
        });

    });
</script>
{{include_file name='home/public/footer'}}